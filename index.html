<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>SimCompanies Oracle</title>
</head>
<body>
    <h1>SimCompanies Oracle</h1>
    <table border="1">
        <thead>
            <tr>
                <th>Artikel</th>
                <th>Preis</th>
            </tr>
        </thead>
        <tbody id="market-table">
            <!-- Tabelle wird hier befüllt -->
        </tbody>
    </table>

    <script>
        async function loadData() {
            // CSV laden
            const csvResponse = await fetch('resources.csv');
            const csvText = await csvResponse.text();
            const lines = csvText.split('\n');
            
            // Mapping id -> name erstellen
            const resourceMap = {};
            lines.forEach(line => {
                const [id, name] = line.split(';'); // Semikolon als Trenner
                if(id && name) resourceMap[id.trim()] = name.trim();
            });

            // Market-API abfragen
            const apiResponse = await fetch('https://www.simcompanies.com/api/v3/market-ticker/0/');
            const marketData = await apiResponse.json();

            // Tabelle füllen
            const tbody = document.getElementById('market-table');
            marketData.forEach(item => {
                const name = resourceMap[item.kind] || `ID ${item.kind}`;
                const row = document.createElement('tr');
                const nameCell = document.createElement('td');
                const priceCell = document.createElement('td');
                nameCell.textContent = name;
                priceCell.textContent = item.price;
                row.appendChild(nameCell);
                row.appendChild(priceCell);
                tbody.appendChild(row);
            });
        }

        loadData();
    </script>
</body>
</html>
